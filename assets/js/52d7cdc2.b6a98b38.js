"use strict";(globalThis.webpackChunkdazzleduck_website=globalThis.webpackChunkdazzleduck_website||[]).push([[7927],{3095:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>a,contentTitle:()=>d,default:()=>h,frontMatter:()=>t,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"dazzleduck-sql-logger/architecture","title":"Architecture","description":"How the log tail \u2192 Arrow \u2192 HTTP ingestion pipeline works.","source":"@site/docs/dazzleduck-sql-logger/architecture.md","sourceDirName":"dazzleduck-sql-logger","slug":"/dazzleduck-sql-logger/architecture","permalink":"/dazzleduck-website/docs/dazzleduck-sql-logger/architecture","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"sidebar_label":"Architecture","sidebar_position":4},"sidebar":"docSidebar","previous":{"title":"Overview","permalink":"/dazzleduck-website/docs/dazzleduck-sql-logger/overview"},"next":{"title":"Installation","permalink":"/dazzleduck-website/docs/dazzleduck-sql-logger/setup"}}');var s=r(4848),l=r(8453);const t={sidebar_label:"Architecture",sidebar_position:4},d="Architecture",a={},c=[{value:"High-Level Design",id:"high-level-design",level:2},{value:"Pipeline Stages",id:"pipeline-stages",level:2},{value:"1. File Tailing",id:"1-file-tailing",level:3},{value:"2. JSON Parsing",id:"2-json-parsing",level:3},{value:"3. Arrow Conversion",id:"3-arrow-conversion",level:3},{value:"4. HTTP Ingestion",id:"4-http-ingestion",level:3},{value:"Threading Model",id:"threading-model",level:2},{value:"Failure &amp; Safety Guarantees",id:"failure--safety-guarantees",level:2},{value:"Performance Characteristics",id:"performance-characteristics",level:2}];function o(e){const n={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"architecture",children:"Architecture"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"How the log tail \u2192 Arrow \u2192 HTTP ingestion pipeline works."}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"high-level-design",children:"High-Level Design"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-text",children:"Log files (*.log)\n      \u2193\nLogFileTailReader\n      \u2193\nLogTailToArrowProcessor\n      \u2193\nJsonToArrowConverter\n      \u2193\nArrow IPC batches\n      \u2193\nHttpProducer\n      \u2193\nDazzleDuck SQL Server (/v1/ingest)\n      \u2193\nParquet in warehouse\n"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"pipeline-stages",children:"Pipeline Stages"}),"\n",(0,s.jsx)(n.h3,{id:"1-file-tailing",children:"1. File Tailing"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Monitors a directory for new and existing log files"}),"\n",(0,s.jsx)(n.li,{children:"Tails appended content only (no rereads)"}),"\n",(0,s.jsx)(n.li,{children:"Handles file rotation and multiple files safely"}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h3,{id:"2-json-parsing",children:"2. JSON Parsing"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Each log line must be a single JSON object"}),"\n",(0,s.jsx)(n.li,{children:"Invalid JSON lines are skipped safely"}),"\n",(0,s.jsx)(n.li,{children:"Parsing errors do not crash the pipeline"}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h3,{id:"3-arrow-conversion",children:"3. Arrow Conversion"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Parsed records are converted into Arrow vectors"}),"\n",(0,s.jsx)(n.li,{children:"Uses a fixed, schema-driven layout"}),"\n",(0,s.jsx)(n.li,{children:"Data is batched to control memory and throughput"}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h3,{id:"4-http-ingestion",children:"4. HTTP Ingestion"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Arrow IPC batches are sent via HTTP to DazzleDuck SQL Server"}),"\n",(0,s.jsxs)(n.li,{children:["Uses ",(0,s.jsx)(n.code,{children:"/v1/ingest"})," endpoint"]}),"\n",(0,s.jsx)(n.li,{children:"Supports JWT authentication and retries"}),"\n",(0,s.jsx)(n.li,{children:"Backpressure is enforced via bounded queues"}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"threading-model",children:"Threading Model"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Component"}),(0,s.jsx)(n.th,{children:"Threading"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"File tailing"}),(0,s.jsx)(n.td,{children:"Background watcher thread"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"JSON parsing"}),(0,s.jsx)(n.td,{children:"Worker thread"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Arrow batching"}),(0,s.jsx)(n.td,{children:"Processor thread"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"HTTP sending"}),(0,s.jsx)(n.td,{children:"Async sender thread"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Backpressure"}),(0,s.jsx)(n.td,{children:"Bounded queues"})]})]})]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"failure--safety-guarantees",children:"Failure & Safety Guarantees"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Application never blocks on log ingestion"}),"\n",(0,s.jsx)(n.li,{children:"Logs may be dropped under sustained pressure"}),"\n",(0,s.jsx)(n.li,{children:"Failures are isolated and logged locally"}),"\n",(0,s.jsx)(n.li,{children:"Pipeline continues running on partial failures"}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"performance-characteristics",children:"Performance Characteristics"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Streaming-friendly"}),"\n",(0,s.jsx)(n.li,{children:"Low memory overhead"}),"\n",(0,s.jsx)(n.li,{children:"No disk writes during processing"}),"\n",(0,s.jsx)(n.li,{children:"Arrow-native columnar transport"}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(o,{...e})}):o(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>t,x:()=>d});var i=r(6540);const s={},l=i.createContext(s);function t(e){const n=i.useContext(l);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:t(e.components),i.createElement(l.Provider,{value:n},e.children)}}}]);